# 9. 운영체제 시작하기

## 9.1 운영체제를 알아야 하는 이유

### 운영체제란

- 시스템 자원
    - 프로그램 실행에 필요한 요소
    - 예시: CPU, 메모리, 보조기억장치, 입출력장치 등과 같은 컴퓨터 부품
    - 모든 프로그램은 실행되기 위해 반드시 자원이 필요
- 운영체제(Operating System)
    - 실행할 프로그램에 필요한 자원을 할당하고, 프로그램이 올바르게 실행되도록 돕는 프로그램
- 운영체제는 컴퓨터가 부팅될 때 메모리 내의 커널 영역(kernel space)이라는 공간에 따로 적재되어 실행됨
- 운영체제의 역할
    - 실행할 프로그램을 메모리에 적재
    - 더 이상 실행되지 않는 프로그램을 메모리에서 삭제하며 지속적으로 메모리 자원 관리
    - 여러 프로그램에 공정하게 CPU 자원 할당
    - 응용 프로그램이 올바르게 실행되도록 관리

### 운영체제를 알아야 하는 이유

- 운영체제가 하드웨어를 조작하고 관리하는 기능을 제공하므로 하드웨어를 조작하는 코드를 직접 작성할 필요 없이 운영체제의 도움을 받아 개발할 수 있음
- 문제 발생 시 오류 메시지를 분석할 수 있음

## 9.2 운영체제의 큰 그림

### 운영체제의 심장, 커널

- 커널(kernel)
    - 운영체제의 핵심 서비스를 담당하는 부분
        - 자원에 접근하고 조작하는 기능
        - 프로그램이 올바르고 안전하게 실행되게 하는 기능
- 사용자 인터페이스는 운영체제가 제공하는 서비스이지만 커널에 속한 기능은 아님
    - 같은 커널을 사용하더라도 사용자 인터페이스는 다를 수 있음

### 이중 모드와 시스템 호출

- 운영체제는 응용 프로그램들이 자원에 접근하려고 할 때 오직 자신을 통해서만 접근하도록 하여 자원을 보호
- 응용 프로그램을 실행할 때, 운영체제가 응용 프로그램 대신 자원에 접근하여 요청한 작업을 수행
- 운영체제의 역할은 이중 모드(dual mode)로써 구현됨
    - CPU가 명령어를 실행하는 모드를 사용자 모드와 커널 모드로 구분하는 방식
    - 사용자 모드(user mode)
        - 운영체제 서비스를 제공받을 수 없는 실행 모드
        - 커널 영역의 코드를 실행할 수 없음
        - 일반적인 응용 프로그램은 기본적으로 사용자 모드로 실행됨
        - 사용자 모드로 실행 중인 CPU는 입출력 명령어와 같이 하드웨어 자원에 접근하는 명령어를 실행할 수 없음
    - 커널 모드(kernel mode)
        - 운영체제 서비스를 제공받을 수 있는 실행 모드
        - 커널 영역의 코드를 실행할 수 있음
        - 운영체제는 커널 모드로 실행되기 때문에 자원에 접근할 수 잇음
    - 사용자 모드로 실행되는 프로그램이 운영체제 서비스를 제공받기 위해서는 운영체제에 시스템 호출(system call)을 보내 커널 모드로 전환되어야 함

### 운영체제의 핵심 서비스

#### 프로세스 관리

- 프로세스(process)
    - 실행 중인 프로그램
- 하나의 CPU는 한 번에 하나의 프로세스만 실행할 수 있기에 CPU는 프로세스들을 조금씩 번갈아 가며 실행함
- 운영체제는 다양한 프로세스를 관리하고 실행함

#### 자원 접근 및 할당

##### CPU

- CPU 스케줄링
    - 운영체제가 프로세스들에 CPU를 할당하기 위해 어떤 프로세스부터, 얼마나 오래 CPU를 이용하게 할지 결정하는 것

##### 메모리

- 운영체제는 새로운 프로세스가 적재될 때마다 어느 주소에 적재해야 할지를 결정

##### 입출력장치

- 운영체제는 인터럽트 서비스 루틴을 제공하여 입출력 작업을 수행

#### 파일 시스템 관리

- 파일을 열고, 생성하고, 삭제하는 서비스

### 가상 머신과 이중 모드의 발전

- 가상 머신(virtual machine)
    - 소프트웨어적으로 만들어낸 가상 컴퓨터
    - 가상 머신을 설치하면 새로운 운영체제와 응용 프로그램을 설치하고 실행할 수 있음
- 가상 머신 상에서 작동하는 응용 프로그램들은 하이퍼바이저 모드로써 가상 머신에 설치된 운영체제로부터 운영체제 서비스를 받을 수 있음